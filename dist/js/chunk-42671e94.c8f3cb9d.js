(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42671e94"],{"898b":function(e,t,o){},"8a67":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"promotion-dialog"},[o("el-form",{ref:"form",attrs:{"label-width":"130px","label-position":"right",model:e.form,rules:e.rules}},[o("p",{staticClass:"el-form-item"},[o("span",{staticClass:"el-form-item__label",staticStyle:{width:"130px"}},[e._v("姓名:")]),o("span",{staticClass:"el-form-item__content"},[e._v(e._s(e.data.name))])]),o("el-form-item",{attrs:{prop:"promotion_id",label:"晋升任务:"}},[o("el-select",{attrs:{placeholder:"晋升任务"},model:{value:e.form.promotion_id,callback:function(t){e.$set(e.form,"promotion_id",t)},expression:"form.promotion_id"}},e._l(e.promotions,(function(e){return o("el-option",{key:e.promotion_id,attrs:{label:e.name,value:e.promotion_id}})})),1)],1),o("p",{staticClass:"el-form-item"},[o("span",{staticClass:"el-form-item__label",staticStyle:{width:"130px"}},[e._v("现职级:")]),o("span",{staticClass:"el-form-item__content"},[e._v(e._s(e.data.level))])]),o("el-form-item",{attrs:{prop:"target_level",label:"目标职级:"}},[o("el-select",{attrs:{disabled:e.promotionLvDisable,placeholder:"目标职级"},on:{change:e.levelChange},model:{value:e.form.target_level,callback:function(t){e.$set(e.form,"target_level",t)},expression:"form.target_level"}},e._l(e.targetLevelArr,(function(e,t){return o("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-form-item",{attrs:{prop:"promotion_type",label:"晋升类型:"}},[o("el-select",{attrs:{placeholder:"晋升类型"},on:{change:e.typeChange},model:{value:e.form.promotion_type,callback:function(t){e.$set(e.form,"promotion_type",t)},expression:"form.promotion_type"}},e._l(e.promotionTypes,(function(e,t){return o("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),o("p",{staticClass:"el-form-item is-required"},[o("span",{staticClass:"el-form-item__label",staticStyle:{width:"130px"}},[e._v("审批意见及评语:")])]),o("el-form-item",{attrs:{prop:"opinion"}},[o("el-input",{attrs:{type:"textarea",rows:4,maxlength:"200","show-word-limit":"",placeholder:"请输入审批意见及评语"},model:{value:e.form.opinion,callback:function(t){e.$set(e.form,"opinion",t)},expression:"form.opinion"}})],1)],1),o("div",{staticClass:"btnGroup"},[o("el-button",{on:{click:e.close}},[e._v("取消")]),o("el-button",{attrs:{loading:e.isLoading,type:"primary"},on:{click:e.submit}},[e._v("确定 ")])],1)],1)},r=[],l=(o("e6cf"),o("a79d"),o("2532"),o("fea5")),a=o("38fb"),s={props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>({})}},data(){return{form:{promotion_id:"",target_level:"",promotion_type:"",opinion:""},rules:{opinion:[{required:!0,message:"请输入审批意见及评语",blur:"blur"}],target_level:[{required:!0,message:"请选择目标级别",trigger:"change"}],promotion_id:[{required:!0,message:"请选择晋升任务",trigger:"change"}],promotion_type:[{required:!0,message:"请选择晋升类型",trigger:"change"}]},promotions:[],promotionTypes:{},isLoading:!1,promotionLvDisable:!1}},methods:{close(){this.$emit("update:visible",!1)},levelChange(e){if(this.form.target_level=e,this.form.promotion_id){var t={workcode:this.data.workcode,target_level:this.form.target_level,promotion_id:this.form.promotion_id};Object(l["bb"])(t).then(e=>{this.promotionTypes=e||{}})}else this.$message.error("请先选择晋升任务"),this.form.target_level=""},typeChange(e){var t=this.form.target_level==this.nextLv&&this.promotionTypes[e].includes("正常");this.promotionLvDisable=t},getPromotions(){Object(l["I"])({workcode:this.data.workcode}).then(e=>{this.promotions=e||[]})},submit(){this.$refs.form.validate(e=>{if(e){var t={promotion_id:this.form.promotion_id,workcode:this.data.workcode,target_level:this.form.target_level,promotion_type:this.form.promotion_type,opinion:this.form.opinion};this.isLoading=!0,Object(l["X"])(t).then(e=>{this.$message.success("提交成功"),this.$emit("refresh"),this.close()}).catch(e=>{}).finally(()=>{this.isLoading=!1})}})}},computed:{targetLevelArr(){var e=a["r"].findIndex(e=>+this.data.level==e),t=a["r"][e+1],o=a["r"][e+2];return this.data.level?[{label:t,value:t},{label:o,value:o}]:[]},nextLv(){var e=a["r"].findIndex(e=>+this.data.level==e);return a["r"][e+1]}},created(){this.getPromotions()}},n=s,m=(o("e0f1"),o("2877")),p=Object(m["a"])(n,i,r,!1,null,"40a2f990",null);t["default"]=p.exports},e0f1:function(e,t,o){"use strict";var i=o("898b"),r=o.n(i);r.a}}]);