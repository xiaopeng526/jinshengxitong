(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e0aa5e5"],{"898b":function(e,t,o){},"8a67":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"promotion-dialog"},[o("el-form",{ref:"form",attrs:{"label-width":"130px","label-position":"right",model:e.form,rules:e.rules}},[o("p",{staticClass:"el-form-item"},[o("span",{staticClass:"el-form-item__label",staticStyle:{width:"130px"}},[e._v("姓名:")]),o("span",{staticClass:"el-form-item__content"},[e._v(e._s(e.data.name))])]),o("el-form-item",{attrs:{prop:"promotion_id",label:"晋升任务:"}},[o("el-select",{attrs:{placeholder:"晋升任务"},model:{value:e.form.promotion_id,callback:function(t){e.$set(e.form,"promotion_id",t)},expression:"form.promotion_id"}},e._l(e.promotions,(function(e){return o("el-option",{key:e.promotion_id,attrs:{label:e.name,value:e.promotion_id}})})),1)],1),o("p",{staticClass:"el-form-item"},[o("span",{staticClass:"el-form-item__label",staticStyle:{width:"130px"}},[e._v("现职级:")]),o("span",{staticClass:"el-form-item__content"},[e._v(e._s(e.data.level))])]),o("el-form-item",{attrs:{prop:"target_level",label:"目标职级:"}},[o("el-select",{attrs:{disabled:e.promotionLvDisable,placeholder:"目标职级"},on:{change:e.levelChange},model:{value:e.form.target_level,callback:function(t){e.$set(e.form,"target_level",t)},expression:"form.target_level"}},e._l(e.targetLevelArr,(function(e,t){return o("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-form-item",{attrs:{prop:"promotion_type",label:"晋升类型:"}},[o("el-select",{attrs:{placeholder:"晋升类型"},on:{change:e.typeChange},model:{value:e.form.promotion_type,callback:function(t){e.$set(e.form,"promotion_type",t)},expression:"form.promotion_type"}},e._l(e.promotionTypes,(function(e,t){return o("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),o("p",{staticClass:"el-form-item is-required"},[o("span",{staticClass:"el-form-item__label",staticStyle:{width:"130px"}},[e._v("审批意见及评语:")])]),o("el-form-item",{attrs:{prop:"opinion"}},[o("el-input",{attrs:{type:"textarea",rows:4,maxlength:"200","show-word-limit":"",placeholder:"请输入审批意见及评语"},model:{value:e.form.opinion,callback:function(t){e.$set(e.form,"opinion",t)},expression:"form.opinion"}})],1)],1),o("div",{staticClass:"btnGroup"},[o("el-button",{on:{click:e.close}},[e._v("取消")]),o("el-button",{attrs:{loading:e.isLoading,type:"primary"},on:{click:e.submit}},[e._v("确定 ")])],1)],1)},r=[],n=(o("c740"),o("caad"),o("d3b7"),o("2532"),o("fea5")),a=o("38fb"),l={props:{visible:{type:Boolean,default:!1},data:{type:Object,default:function(){return{}}}},data:function(){return{form:{promotion_id:"",target_level:"",promotion_type:"",opinion:""},rules:{opinion:[{required:!0,message:"请输入审批意见及评语",blur:"blur"}],target_level:[{required:!0,message:"请选择目标级别",trigger:"change"}],promotion_id:[{required:!0,message:"请选择晋升任务",trigger:"change"}],promotion_type:[{required:!0,message:"请选择晋升类型",trigger:"change"}]},promotions:[],promotionTypes:{},isLoading:!1,promotionLvDisable:!1}},methods:{close:function(){this.$emit("update:visible",!1)},levelChange:function(e){var t=this;if(this.form.target_level=e,this.form.promotion_id){var o={workcode:this.data.workcode,target_level:this.form.target_level,promotion_id:this.form.promotion_id};Object(n["bb"])(o).then((function(e){t.promotionTypes=e||{}}))}else this.$message.error("请先选择晋升任务"),this.form.target_level=""},typeChange:function(e){var t=this.form.target_level==this.nextLv&&this.promotionTypes[e].includes("正常");this.promotionLvDisable=t},getPromotions:function(){var e=this;Object(n["I"])({workcode:this.data.workcode}).then((function(t){e.promotions=t||[]}))},submit:function(){var e=this;this.$refs.form.validate((function(t){if(t){var o={promotion_id:e.form.promotion_id,workcode:e.data.workcode,target_level:e.form.target_level,promotion_type:e.form.promotion_type,opinion:e.form.opinion};e.isLoading=!0,Object(n["X"])(o).then((function(t){e.$message.success("提交成功"),e.$emit("refresh"),e.close()})).catch((function(e){})).finally((function(){e.isLoading=!1}))}}))}},computed:{targetLevelArr:function(){var e=this,t=a["r"].findIndex((function(t){return+e.data.level==t})),o=a["r"][t+1],i=a["r"][t+2];return this.data.level?[{label:o,value:o},{label:i,value:i}]:[]},nextLv:function(){var e=this,t=a["r"].findIndex((function(t){return+e.data.level==t}));return a["r"][t+1]}},created:function(){this.getPromotions()}},s=l,m=(o("e0f1"),o("2877")),c=Object(m["a"])(s,i,r,!1,null,"40a2f990",null);t["default"]=c.exports},c740:function(e,t,o){"use strict";var i=o("23e7"),r=o("b727").findIndex,n=o("44d2"),a=o("ae40"),l="findIndex",s=!0,m=a(l);l in[]&&Array(1)[l]((function(){s=!1})),i({target:"Array",proto:!0,forced:s||!m},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(l)},e0f1:function(e,t,o){"use strict";var i=o("898b"),r=o.n(i);r.a}}]);