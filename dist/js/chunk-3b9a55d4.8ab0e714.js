(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b9a55d4"],{1806:function(e,t,r){"use strict";var i=r("e3f6"),n=r.n(i);n.a},"498a":function(e,t,r){"use strict";var i=r("23e7"),n=r("58a8").trim,s=r("c8d2");i({target:"String",proto:!0,forced:s("trim")},{trim:function(){return n(this)}})},"57c6":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.visible?r("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.outside,expression:"outside"}],staticClass:"objectTree-container"},[r("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),r("el-tree",{ref:"tree",attrs:{props:e.defaultProps,"default-checked-keys":e.checkedKeys,"node-key":"id","filter-node-method":e.filterNode,"show-checkbox":"",data:e.treeOps},on:{"check-change":e.treeChange}})],1):e._e()},n=[],s=(r("c975"),r("ade3"));function a(e,t,r){var i=t.modifiers.bubble,n=r=>{(i||!e.contains(r.target)&&e!==r.target)&&t.value(r)};e.__vueClickOutside__=n,document.addEventListener("click",n)}function o(e,t){document.removeEventListener("click",e.__vueClickOutside__),e.__vueClickOutside__=null}var l={bind:a,unbind:o};function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=r("f7fe"),m={props:{visible:{type:Boolean,default:!1},data:{type:Array,default:()=>[]},pmt:{type:Array,default:()=>[]},checkedNodes:{type:Array,default:()=>[]},exclusive:{type:Boolean,default:!1},leafOnly:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1}},data(){return{defaultProps:{label:"name"},filterText:"",tree:this.data,isMounting:!0}},methods:{filterNode(e,t){return!e||-1!==t.name.indexOf(e)},treeChange:d((function(e,t,r){var i=this.$refs.tree.getCheckedNodes(this.leafOnly);if(this.exclusive){if(t){var n=this.findRoot(e.id).id;this.disabledOtherBranch(n)}0==i.length&&this.enableAll()}this.$emit("update:checkedNodes",i.map(e=>{var{name:t,id:r}=e;return{name:t,department_id:r}}))}),500),findRoot(e){for(var t={},r=0;r<this.data.length;r++)if(t=this.data[r],this.findNode(e,this.data[r]))return t},findNode(e,t){if(t.id==e)return!0;var r=t.children;if(r&&r.length>0)for(var i=0;i<r.length;i++)if(this.findNode(e,r[i]))return!0;return!1},disabledOtherBranch(e){for(var t=this.tree,r=0;r<t.length;r++)t[r].id!=e&&(t[r]=this.disableNode(t[r],!0),this.$set(t,r,u({},t[r])))},disableNode(e,t){e.disabled=t;var r=e.children;return r&&r.length>0&&(e.children=r.map(e=>this.disableNode(e,t))),e},expandNode(e,t){e.expanded=t;var r=e.children;return r&&r.length>0&&(e.children=r.map(e=>this.expandNode(e,t))),e},enableAll(){for(var e=this.tree,t=0;t<e.length;t++)e[t]=this.disableNode(e[t],!1),this.$set(e,t,u({},e[t]))},collapseAll(){for(var e=this.tree,t=0;t<e.length;t++)e[t]=this.expandNode(e[t],!1),this.$set(e,t,u({},e[t]))},outside(){this.isMounting||this.$emit("update:visible",!1)}},watch:{filterText:d((function(e){e||this.collapseAll(),this.$refs.tree.filter(e)}),500),data(e){this.tree=e}},computed:{checkedKeys(){return this.checkedNodes.map(e=>{var{department_id:t}=e;return t})},treeOps(){return this.tree||this.data}},directives:{"click-outside":l},mounted(){this.visible&&this.appendToBody&&document.body.appendChild(this.$el),this.$nextTick((function(){setTimeout(()=>{this.isMounting=!1},1e3)}))},destroyed(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},p=m,f=(r("f556"),r("2877")),h=Object(f["a"])(p,i,n,!1,null,"76de543a",null);t["a"]=h.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var i=r("1d80"),n=r("5899"),s="["+n+"]",a=RegExp("^"+s+s+"*"),o=RegExp(s+s+"*$"),l=function(e){return function(t){var r=String(i(t));return 1&e&&(r=r.replace(a,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:l(1),end:l(2),trim:l(3)}},c8d2:function(e,t,r){var i=r("d039"),n=r("5899"),s="​᠎";e.exports=function(e){return i((function(){return!!n[e]()||s[e]()!=s||n[e].name!==e}))}},e3f6:function(e,t,r){},eb08:function(e,t,r){},ec65:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-data-dialog"},[r("h1",{staticClass:"title"},[e._v(e._s(e.dialogTitle))]),r("div",{staticClass:"content"},[r("el-form",{ref:"userForm",attrs:{"label-width":"100px",model:e.userForm,rules:e.rules}},[r("el-form-item",{attrs:{label:e.constants.FORM_ENTERPRISE_EMAIL,prop:"email"}},[r("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入内容",disabled:e.isEdit},on:{select:e.selectEmail},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email","string"===typeof t?t.trim():t)},expression:"userForm.email"}})],1),r("el-form-item",{attrs:{label:e.constants.FORM_NAME,prop:"name"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1),r("el-form-item",{attrs:{label:e.constants.FORM_DEPARTMENT,prop:"department"}},[r("el-input",{attrs:{placeholder:"请选择部门",readonly:"readonly"},nativeOn:{click:function(t){t.stopPropagation(),e.showDepartmentTree=!e.showDepartmentTree}},model:{value:e.dp_name,callback:function(t){e.dp_name=t},expression:"dp_name"}})],1),r("el-form-item",{attrs:{label:e.constants.FORM_LEVEL,prop:"level"}},[r("el-checkbox-group",{model:{value:e.userForm.level,callback:function(t){e.$set(e.userForm,"level",t)},expression:"userForm.level"}},e._l(e.levels,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id,name:"levels"}},[e._v(e._s(t.name))])})),1)],1),r("el-form-item",{attrs:{label:e.constants.FORM_ROLE,prop:"role"}},[r("el-checkbox-group",{model:{value:e.userForm.role,callback:function(t){e.$set(e.userForm,"role",t)},expression:"userForm.role"}},e._l(e.roles,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id,name:"role"}},[e._v(e._s(t.name))])})),1)],1),r("el-form-item",{staticClass:"btn-group"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:e.close}},[e._v(e._s(e.constants.BTN_CANCLE))]),r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm("userForm")}}},[e._v(e._s(e.constants.BTN_CONFIRM))])],1)],1)],1),r("el-drawer",{attrs:{"append-to-body":!0,direction:"ltr",visible:e.showDepartmentTree},on:{"update:visible":function(t){e.showDepartmentTree=t}}},[e.showDepartmentTree?r("TreeSelectPanel",{attrs:{checkedNodes:e.userForm.department,visible:e.showDepartmentTree,data:e.departmentArr},on:{"update:checkedNodes":function(t){return e.$set(e.userForm,"department",t)},"update:checked-nodes":function(t){return e.$set(e.userForm,"department",t)},"update:visible":function(t){e.showDepartmentTree=t}}}):e._e()],1)],1)},n=[],s=(r("498a"),r("fea5")),a=r("57c6"),o=r("38fb"),l={props:{actionType:{type:String,default:"add"},Id:{type:[String,Number],default:""}},data(){return{showDepartmentTree:!1,loading:!1,userForm:{email:"",name:"",department:[],level:[],role:[]},roles:[],levels:[{id:"1",name:"普通员工"},{id:"2",name:"组织部成员"}],departmentArr:[],rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],email:[{required:!0,message:"请输入企业邮箱",trigger:"blur"}],level:[{type:"array",required:!0,message:"请至少选择一个职级",trigger:"change"}],department:[{type:"array",required:!0,message:"请至少选择一个部门",trigger:"change"}],role:[{type:"array",required:!0,message:"请选择角色",trigger:"change"}]},constants:{FORM_ENTERPRISE_EMAIL:o["h"],FORM_FAMILY_GROUP:o["i"],FORM_DEPARTMENT:o["g"],FORM_LEVEL:o["j"],FORM_ROLE:o["l"],BTN_CANCLE:o["c"],BTN_CONFIRM:o["d"],FORM_NAME:o["k"]}}},methods:{getDepartments(){Object(s["G"])().then(e=>{this.departmentArr=e})},getUserRoles(){Object(s["A"])().then(e=>{this.roles=e})},close(){this.$emit("update:visible",!1)},submitForm(e){this.$refs[e].validate(e=>{if(!e)return!1;this.submitFunc(this.afterSubmit)})},searchUserBasicInfo(e){return Object(s["cb"])({keywords:e})},addUserSubmit(e){Object(s["e"])(this.getParams()).then(t=>(this.$message({message:"添加成功!",type:"success"}),e&&e()))},modifyUserSubmit(e){var t=this.getParams();Object(s["N"])(this.Id,t).then(t=>(this.$message({message:"修改成功!",type:"success"}),e&&e()))},afterSubmit(){this.$emit("refresh"),this.close()},querySearchAsync(e,t){this.isEdit&&this.loading&&(this.userForm.name=""),e.trim()?this.searchUserBasicInfo(e).then(e=>{t(e.map(e=>(e.value=e.email,e))||[])}):t([])},selectEmail(e){this.userForm.workcode=e.workcode,this.userForm.name=e.name},getParams(){return{workcode:this.userForm.workcode,email:this.userForm.email,name:this.userForm.name,target_rank:this.userForm.level,departments:this.dpIds,roles:this.userForm.role}},getUserDetail(){Object(s["L"])(this.Id).then(e=>{this.userForm.name=e.name,this.userForm.email=e.email,this.userForm.workcode=e.workcode,this.userForm.level=e.target_rank,this.userForm.role=e.roles,this.userForm.department=e.departments,this.$nextTick((function(){this.loading=!1}))})}},components:{TreeSelectPanel:a["a"]},computed:{dp_name(){return this.userForm.department.map(e=>e.name).join(", ")},dpIds(){return this.userForm.department.map(e=>{var{department_id:t}=e;return t})},dialogTitle(){return"add"==this.actionType?o["x"]:o["z"]},submitFunc(){return"add"==this.actionType?this.addUserSubmit:this.modifyUserSubmit},isEdit(){return"add"!=this.actionType}},created(){this.getDepartments(),this.getUserRoles(),this.isEdit&&this.getUserDetail()}},c=l,u=(r("1806"),r("2877")),d=Object(u["a"])(c,i,n,!1,null,"1070d718",null);t["default"]=d.exports},f556:function(e,t,r){"use strict";var i=r("eb08"),n=r.n(i);n.a},f7fe:function(e,t,r){(function(t){var r="Expected a function",i=NaN,n="[object Symbol]",s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,m=u||d||Function("return this")(),p=Object.prototype,f=p.toString,h=Math.max,v=Math.min,b=function(){return m.Date.now()};function g(e,t,i){var n,s,a,o,l,c,u=0,d=!1,m=!1,p=!0;if("function"!=typeof e)throw new TypeError(r);function f(t){var r=n,i=s;return n=s=void 0,u=t,o=e.apply(i,r),o}function g(e){return u=e,l=setTimeout(k,t),d?f(e):o}function O(e){var r=e-c,i=e-u,n=t-r;return m?v(n,a-i):n}function _(e){var r=e-c,i=e-u;return void 0===c||r>=t||r<0||m&&i>=a}function k(){var e=b();if(_(e))return T(e);l=setTimeout(k,O(e))}function T(e){return l=void 0,p&&n?f(e):(n=s=void 0,o)}function w(){void 0!==l&&clearTimeout(l),u=0,n=c=s=l=void 0}function x(){return void 0===l?o:T(b())}function N(){var e=b(),r=_(e);if(n=arguments,s=this,c=e,r){if(void 0===l)return g(c);if(m)return l=setTimeout(k,t),f(c)}return void 0===l&&(l=setTimeout(k,t)),o}return t=F(t)||0,y(i)&&(d=!!i.leading,m="maxWait"in i,a=m?h(F(i.maxWait)||0,t):a,p="trailing"in i?!!i.trailing:p),N.cancel=w,N.flush=x,N}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function O(e){return!!e&&"object"==typeof e}function _(e){return"symbol"==typeof e||O(e)&&f.call(e)==n}function F(e){if("number"==typeof e)return e;if(_(e))return i;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=o.test(e);return r||l.test(e)?c(e.slice(2),r?2:8):a.test(e)?i:+e}e.exports=g}).call(this,r("c8ba"))}}]);